# Changelog


## v0.0.2


### 🚀 Enhancements

  - **multipart.ts:** Add multipart data parsing utility function This commit adds a new utility function to parse multipart data. The function takes in a multipart body buffer and a boundary string and returns an array of objects containing the parsed data. The implementation is based on two existing libraries and is licensed under the MIT license. ([eb4a787](https://github.com/nyxblabs/http-lean/commit/eb4a787))
  - **app.ts): add support for creating a lean web application with a middleware stack ✨ feat(error.ts:** Add support for creating and handling LeanError objects The `createApp` function creates a new lean web application with a middleware stack. The `use` function is used to add middleware to the stack. The `createAppEventHandler` function creates an event handler that can be used to handle incoming requests. The `LeanError` class is a subclass of the `Error` class that can be used to handle both internal and runtime errors. The `createError` function creates a new `LeanError` object. The `sendError` function is used to send an error response to the client. The `isError` function is used to check if an object is an instance of `LeanError`. ([572e36a](https://github.com/nyxblabs/http-lean/commit/572e36a))
  - **index.ts, node.ts:** Add Node.js types and utilities for handling HTTP requests and responses This commit adds Node.js types and utilities for handling HTTP requests and responses. The `index.ts` file exports all the new modules, while the `node.ts` file contains the implementation of the Node.js types and utilities. The new types and utilities include `NodeIncomingMessage`, `NodeServerResponse`, `NodeListener`, `NodePromisifiedHandler`, `NodeMiddleware`, `defineNodeListener`, `defineNodeMiddleware`, `fromNodeMiddleware`, `toNodeListener`, `promisifyNodeListener`, and `callNodeListener`. These new types and utilities will be useful for handling HTTP requests and responses in Node.js applications. ([62a90e2](https://github.com/nyxblabs/http-lean/commit/62a90e2))
  - **router.ts:** Add router module with support for HTTP methods and middleware This commit adds a new router module that provides support for HTTP methods and middleware. The router module is built on top of radix-rapid and provides a simple and flexible way to define routes and middleware. The router module supports all HTTP methods and provides a way to define middleware for each route. The router module also supports the use of the 'all' method to define middleware that will be executed for all HTTP methods. The router module is designed to be used with the event module and provides a way to define event handlers for each route. The router module also provides a way to define lazy event handlers that can be loaded on demand. The types module is also added to provide types for the router module. ([851d7a6](https://github.com/nyxblabs/http-lean/commit/851d7a6))
  - **event.ts:** Add LeanEvent class and LEANHeaders class The LeanEvent class is a class that implements the FetchEvent interface and provides a way to respond to incoming requests. It also provides a way to access the request and response objects. The LEANHeaders class is a class that implements the Headers interface and provides a way to manipulate HTTP headers. ([fe4d8a8](https://github.com/nyxblabs/http-lean/commit/fe4d8a8))
  - **event:** Add LEANResponse class to handle HTTP responses The LEANResponse class is added to handle HTTP responses. It implements the Response interface and provides methods to handle the response body in various formats. The class also has properties to handle the response status, headers, and other metadata. The class is exported from the index.ts file along with other event-related classes. ([9018ba1](https://github.com/nyxblabs/http-lean/commit/9018ba1))
  - **utils.ts): add utility functions for handling event handlers, reading raw body, and parsing request body ✨ feat(utils.ts:** Add `defineEventHandler`, `eventHandler`, `isEventHandler`, `toEventHandler`, `dynamicEventHandler`, `defineLazyEventHandler`, `lazyEventHandler`, `readRawBody`, `readBody`, and `readMultipartFormData` functions to improve code reusability and readability The `defineEventHandler`, `eventHandler`, `isEventHandler`, `toEventHandler`, `dynamicEventHandler`, `defineLazyEventHandler`, and `lazyEventHandler` functions are added to provide a more consistent and readable way of defining and handling event handlers. The `readRawBody`, `readBody`, and `readMultipartFormData` functions are added to provide a more convenient way of reading and parsing request bodies. ([9e0a9c3](https://github.com/nyxblabs/http-lean/commit/9e0a9c3))
  - **cache.ts): add caching utility function to handle caching headers 🆕 feat(consts.ts:** Add MIMES constant object to store MIME types The `handleCacheHeaders` function is added to the `cache.ts` file to handle caching headers. It checks the request caching headers and adds caching headers (Last-Modified, Cache-Control) to the response. The function returns `true` when cache headers are matching, indicating that no response should be sent anymore. The `MIMES` constant object is added to the `consts.ts` file to store MIME types. ([13903e8](https://github.com/nyxblabs/http-lean/commit/13903e8))
  - **cookie.ts): add cookie utility functions to parse, get, set and delete cookies 🚀 feat(index.ts:** Export cookie utility functions The cookie utility functions parseCookies, getCookie, setCookie and deleteCookie have been added to the codebase. These functions allow for easy manipulation of cookies in the HTTP request and response headers. The index.ts file has been updated to export these new utility functions. ([468b408](https://github.com/nyxblabs/http-lean/commit/468b408))
  - **proxy.ts): add proxyRequest and sendProxy functions to handle proxying requests to a target server ✨ feat(request.ts:** Add utility functions to extract request information such as headers, method, and URL The proxy.ts file now contains two functions, proxyRequest and sendProxy, which can be used to proxy requests to a target server. The request.ts file now contains utility functions to extract request information such as headers, method, and URL. These functions can be used to build a request object that can be passed to the proxyRequest function. ([567c3e5](https://github.com/nyxblabs/http-lean/commit/567c3e5))
  - **response.ts): add utility functions for handling HTTP responses ✨ feat(route.ts:** Add utility function for handling route base paths The `response.ts` file now contains utility functions for handling HTTP responses, such as sending a response with an empty payload, setting the response status, getting the response status, setting and getting response headers, and sending a stream. The `route.ts` file now contains a utility function for handling route base paths, which removes the base path from the request URL. These changes improve the codebase's modularity and readability. ([caeefdf](https://github.com/nyxblabs/http-lean/commit/caeefdf))
  - **sanitize.ts): add sanitizeStatusMessage and sanitizeStatusCode functions ✨ feat(session.ts:** Add useSession, getSession, updateSession, sealSession, unsealSession, and clearSession functions to manage sessions sanitizeStatusMessage and sanitizeStatusCode functions were added to sanitize status messages and status codes respectively. These functions are used to remove any disallowed characters from the status message and to ensure that the status code is within the valid range of 100 to 999. ([e46de8b](https://github.com/nyxblabs/http-lean/commit/e46de8b))
  - **cors:** Add CORS utility functions and handler This commit adds a new module for handling CORS requests. The `handleCors` function is responsible for handling CORS requests and returns a boolean indicating whether the request was a preflight request or not. The module also exports utility functions for checking if a request is a preflight request, checking if a given origin is allowed, and appending CORS headers to a response. The `LeanCorsOptions` type is also exported for use in configuring the CORS behavior. ([310edc0](https://github.com/nyxblabs/http-lean/commit/310edc0))
  - **cors:** Add CORS utility functions to handle CORS headers This commit adds utility functions to handle CORS headers. The `resolveCorsOptions` function resolves the CORS options and returns a `LeanResolvedCorsOptions` object. The `isPreflightRequest` function checks if the request is a preflight request. The `isCorsOriginAllowed` function checks if the origin is allowed. The `createOriginHeaders`, `createMethodsHeaders`, `createCredentialsHeaders`, `createAllowHeaderHeaders`, `createExposeHeaders`, and `createMaxAgeHeader` functions create the respective CORS headers. The `appendCorsPreflightHeaders` and `appendCorsHeaders` functions append the CORS headers to the response. ([8332361](https://github.com/nyxblabs/http-lean/commit/8332361))
  - **app.test.ts:** Add tests for various use cases of the app This commit adds tests for various use cases of the app, including returning JSON, returning a 204 response, returning primitive values, returning a buffer, returning HTML, matching simple prefixes, chaining .use calls, using async routes, using route arrays, using handler arrays, prohibiting use of next() in non-promisified handlers, handling next() call with no routes matching, taking an object, short-circuiting route matching, using a custom matcher, and normalizing route definitions. These tests ensure that the app works as expected and can handle various use cases. ([7597d92](https://github.com/nyxblabs/http-lean/commit/7597d92))
  - **e2e.test.ts:** Add end-to-end tests for the server This commit adds end-to-end tests for the server using the supertest library. The tests ensure that the server can serve requests, return 404s, and return 500s. The tests also use the createApp function and eventHandler middleware from the src directory to create and configure the app. ([8d40fed](https://github.com/nyxblabs/http-lean/commit/8d40fed))
  - **header.test.ts): add tests for header-related functions ✨ feat(integrations.test.ts:** Add tests for integrations with other frameworks The header.test.ts file contains tests for functions related to headers, such as getRequestHeaders, getHeaders, getRequestHeader, getHeader, setResponseHeaders, setHeaders, setResponseHeader, setHeader, appendResponseHeaders, appendHeaders, appendResponseHeader, and appendHeader. These tests ensure that the functions work as expected and can set, get, and append headers correctly. ([50f3564](https://github.com/nyxblabs/http-lean/commit/50f3564))
  - **lazy.test.ts): add tests for lazy loading of handlers ✨ feat(proxy.test.ts:** Add tests for proxying requests and cookie domain/path rewriting The `lazy.test.ts` file contains tests for the lazy loading of handlers. The tests cover the ability to load handlers lazily from both default and non-default exports, as well as the ability to handle both synchronous and asynchronous functions that don't return promises. ([49adda5](https://github.com/nyxblabs/http-lean/commit/49adda5))
  - **README.md:** Add initial version of README.md file This commit adds the initial version of the README.md file, which includes a brief description of the http-lean package, its features, installation instructions, usage examples, and a list of available utilities. The README.md file also includes badges for npm version, npm downloads, bundle size, and license. Additionally, the README.md file includes a cover image. ([8011605](https://github.com/nyxblabs/http-lean/commit/8011605))

### 🩹 Fixes

  - **package.json): update test script to include update flag for vitest 🚚 chore(route.ts:** Update import statement to use url-ops instead of ufo The test script now includes the update flag for vitest to ensure that snapshots are updated when running tests. The import statement in route.ts has been updated to use url-ops instead of ufo to improve the readability of the code. ([0ec0472](https://github.com/nyxblabs/http-lean/commit/0ec0472))
  - **eslintrc): fix typo in "@next/next/no-html-link-for-pages" rule name ✨ feat(playground): add new playground example 🚀 chore(playground): add server.cjs file to playground example 🐛 fix(utils/response.ts): fix typo in LeanEvent type name 🚀 chore(vitest.config.ts:** Add coverage reporters to vitest config The "@next/next/no-html-link-for-page" rule name was fixed to "@next/next/no-html-link-for-pages". A new playground example was added, which includes a server.cjs file and an index.ts file. The LeanEvent type name was fixed in the utils/response.ts file. The vitest.config.ts file was updated to include coverage reporters. ([e27d90c](https://github.com/nyxblabs/http-lean/commit/e27d90c))

### 🏡 Chore

  - **package.json:** Remove nyxr test command from release script The nyxr test command was removed from the release script as it was causing issues with the release process. The command was not necessary for the release process and was causing unnecessary delays. ([a5954c0](https://github.com/nyxblabs/http-lean/commit/a5954c0))
  - **.eslintignore): add README.md to ignored files 🆕 feat(.github/assets:** Add cover-github-http-lean.png The README.md file is now ignored by eslint. A new image file cover-github-http-lean.png has been added to the .github/assets directory. ([53fbf18](https://github.com/nyxblabs/http-lean/commit/53fbf18))

### ✅ Tests

  - **error.test.ts:** Add tests for error handling middleware This commit adds tests for the error handling middleware in the application. The tests cover logging errors, returning errors, sending internal errors, sending runtime errors, handling errors in promises, and handling returned errors. The tests ensure that the error handling middleware works as expected and returns the correct status codes and messages. ([1e0d673](https://github.com/nyxblabs/http-lean/commit/1e0d673))
  - **cors.test.ts:** Add tests core ([e058ab8](https://github.com/nyxblabs/http-lean/commit/e058ab8))
  - **router.test.ts): add unit tests for router functionality ✨ feat(utils.test.ts:** Add unit tests for utility functions The added unit tests ensure that the router functionality works as expected. The tests cover handling of routes, methods, query parameters, and router parameters. The utility functions are also tested to ensure that they work as expected. The functions tested include `sendRedirect`, `useBase`, `getQuery`, `getMethod`, `getRequestURL`, and `assertMethod`. ([a71b0df](https://github.com/nyxblabs/http-lean/commit/a71b0df))

### ❤️  Contributors

- Nyxb <contact@nyxb.xyz>

